<!DOCTYPE html>
<html lang="ka">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- CACHE PREVENTION -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    
    <title>ფეხბურთის ჩემპიონატი</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            background: rgba(255,255,255,0.1);
            padding: 10px;
            border-radius: 10px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .tab {
            padding: 12px 24px;
            background: rgba(255,255,255,0.2);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s;
        }

        .tab:hover {
            background: rgba(255,255,255,0.3);
        }

        .tab.active {
            background: white;
            color: #667eea;
        }

        .content {
            display: none;
        }

        .content.active {
            display: block;
        }

        .groups-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .standings-container {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-top: 20px;
        }
        
        @media (max-width: 768px) {
            .standings-container {
                grid-template-columns: 1fr;
            }
        }

        .group {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .group-header {
            font-size: 1.5em;
            font-weight: bold;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 3px solid #667eea;
            color: #667eea;
        }

        .group-team {
            padding: 10px;
            margin: 8px 0;
            background: #f8f9fa;
            border-radius: 6px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        /* ძველი დიზაინი ტურნირის ცხრილისთვის */
        .standings-table {
            width: 100%;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            margin-top: 10px;
        }

        .standings-table table {
            width: 100%;
            border-collapse: collapse;
        }

        .standings-table th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 12px;
            text-align: left;
            font-size: 14px;
        }

        .standings-table td {
            padding: 10px 12px;
            border-bottom: 1px solid #eee;
        }

        .standings-table tr:hover {
            background: #f8f9fa;
        }

        .position {
            font-weight: bold;
            color: #667eea;
        }

        .playoff-bracket {
            background: white;
            padding: 30px;
            border-radius: 10px;
            overflow-x: auto;
        }

        .bracket-round {
            display: flex;
            flex-direction: column;
            justify-content: space-around;
            min-height: 400px;
        }

        .bracket-match {
            background: #f8f9fa;
            border: 2px solid #667eea;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            min-width: 200px;
        }

        .bracket-team {
            padding: 8px;
            margin: 4px 0;
            background: white;
            border-radius: 4px;
            display: flex;
            justify-content: space-between;
        }

        .bracket-container {
            display: flex;
            gap: 40px;
            justify-content: center;
        }

        .qualified {
            background: #d4edda !important;
            border-color: #28a745 !important;
        }

        .stage-complete {
            background: #d4edda;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
            text-align: center;
            font-weight: bold;
            color: #155724;
        }

        /* მობილურისთვის ოპტიმიზირებული დიზაინი მხოლოდ ბომბარდირებისთვის */
        .scorers-list {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            overflow-x: auto;
        }

        .scorers-list .standings-table {
            overflow-x: auto;
        }

        .scorers-list .standings-table table {
            min-width: 500px;
        }

        @media (max-width: 768px) {
            .scorers-list .standings-table th {
                padding: 10px 8px;
                font-size: 13px;
            }
            
            .scorers-list .standings-table td {
                padding: 8px 6px;
                font-size: 13px;
            }
            
            .scorers-list {
                padding: 15px;
            }
        }

        @media (max-width: 480px) {
            .scorers-list .standings-table th {
                padding: 8px 6px;
                font-size: 12px;
            }
            
            .scorers-list .standings-table td {
                padding: 6px 4px;
                font-size: 12px;
            }
            
            .scorers-list .standings-table table {
                min-width: 400px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>⚽ KIU-ს ფეხბურთის ჩემპიონატი 2025</h1>
        </header>

        <div class="tabs">
            <button class="tab active" onclick="showTab('draw')">კენჭისყრა</button>
            <button class="tab" onclick="showTab('standings')">ტურნირის ცხრილი</button>
            <button class="tab" onclick="showTab('playoff')">პლეი-ოფი</button>
            <button class="tab" onclick="showTab('scorers')">ბომბარდირები</button>
        </div>

        <div id="draw" class="content active">
            <div class="groups-container">
                <div class="group">
                    <div class="group-header">ჯგუფი A (5 გუნდი)</div>
                    <div id="groupA"></div>
                </div>
                <div class="group">
                    <div class="group-header">ჯგუფი B (5 გუნდი)</div>
                    <div id="groupB"></div>
                </div>
                <div class="group">
                    <div class="group-header">ჯგუფი C (6 გუნდი)</div>
                    <div id="groupC"></div>
                </div>
                <div class="group">
                    <div class="group-header">ჯგუფი D (6 გუნდი)</div>
                    <div id="groupD"></div>
                </div>
            </div>
        </div>

        <div id="standings" class="content">
            <div class="standings-container">
                <div class="group" id="standingsA"></div>
                <div class="group" id="standingsB"></div>
                <div class="group" id="standingsC"></div>
                <div class="group" id="standingsD"></div>
            </div>
        </div>

        <div id="playoff" class="content">
            <div class="playoff-bracket">
                <h2 style="text-align: center; margin-bottom: 30px; color: #667eea;">პლეი-ოფი</h2>
                <div id="groupStageStatus"></div>
                <div class="bracket-container" id="bracketContainer"></div>
            </div>
        </div>

        <div id="scorers" class="content">
            <div class="scorers-list">
                <h2>ბომბარდირების ცხრილი</h2>
                <div id="topScorersTable"></div>
            </div>
        </div>
    </div>

<script>
    // Add cache busting - force reload if page was cached
    if (window.performance && window.performance.navigation.type === 2) {
        window.location.reload();
    }

    // Global variables
    let groups, standings, scorers, playoffMatches;

    async function loadTournamentData() {
        try {
            // Using your actual GitHub raw URL
            const response = await fetch('https://raw.githubusercontent.com/RatiMghvdeladze/football-tournament-2025/main/tournament-data.json');
            
            if (!response.ok) {
                throw new Error('Network response was not ok');
            }
            
            const tournamentData = await response.json();
            initializeApp(tournamentData);
        } catch (error) {
            console.error('Error loading tournament data:', error);
            // Show a user-friendly error message
            document.body.innerHTML = `
                <div style="color: white; text-align: center; padding: 50px;">
                    <h2>Error loading tournament data</h2>
                    <p>Please check your internet connection and try again.</p>
                    <button onclick="location.reload()" style="padding: 10px 20px; margin-top: 20px; background: white; border: none; border-radius: 5px; cursor: pointer;">Retry</button>
                </div>
            `;
        }
    }

    function initializeApp(tournamentData) {
        groups = tournamentData.groups;
        standings = tournamentData.standings;
        scorers = tournamentData.scorers;
        playoffMatches = tournamentData.playoffMatches;

        // Your existing functions
        updateGroupDisplay();
        updateStandings();
        updatePlayoff();
        updateTopScorers();
    }

    // Your existing functions remain exactly the same
    function updateGroupDisplay() {
        ['A', 'B', 'C', 'D'].forEach(group => {
            const container = document.getElementById(`group${group}`);
            if (!container) return;
            
            container.innerHTML = '';
            groups[group].forEach(team => {
                const div = document.createElement('div');
                div.className = 'group-team';
                div.innerHTML = `<span>${team}</span>`;
                container.appendChild(div);
            });
        });
    }

    function updateStandings() {
        ['A', 'B', 'C', 'D'].forEach(group => {
            const container = document.getElementById(`standings${group}`);
            if (!container || !standings[group]) return;
            
            const sorted = Object.entries(standings[group])
                .sort(([,a], [,b]) => b.points - a.points || b.gd - a.gd || b.gf - a.gf);

            container.innerHTML = `
                <div class="group-header">ჯგუფი ${group}</div>
                <div class="standings-table">
                    <table>
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>გუნდი</th>
                                <th>თ</th>
                                <th>მ</th>
                                <th>ფ</th>
                                <th>წ</th>
                                <th>გატ</th>
                                <th>გაშ</th>
                                <th>სხვ</th>
                                <th>ქულა</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${sorted.map(([team, stats], index) => `
                                <tr class="${index < 3 ? 'qualified' : ''}">
                                    <td class="position">${index + 1}</td>
                                    <td><strong>${team}</strong></td>
                                    <td>${stats.played || 0}</td>
                                    <td>${stats.won || 0}</td>
                                    <td>${stats.drawn || 0}</td>
                                    <td>${stats.lost || 0}</td>
                                    <td>${stats.gf || 0}</td>
                                    <td>${stats.ga || 0}</td>
                                    <td>${stats.gd > 0 ? '+' : ''}${stats.gd || 0}</td>
                                    <td><strong>${stats.points || 0}</strong></td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                </div>
            `;
        });
    }

    function updatePlayoff() {
        const statusContainer = document.getElementById('groupStageStatus');
        const bracket = document.getElementById('bracketContainer');
        
        if (!statusContainer || !bracket) return;
        
        statusContainer.innerHTML = '';
        
        bracket.innerHTML = `
            <div class="bracket-round">
                <h3 style="text-align: center; color: #667eea;">მერვედფინალი</h3>
                ${playoffMatches.round16.map(match => `
                    <div class="bracket-match">
                        <div class="bracket-team ${match.winner === match.team1 ? 'qualified' : ''}">
                            ${match.team1} 
                            ${match.score1 !== null ? 
                                (match.penaltyScore1 !== null ? 
                                    `${match.score1}(${match.penaltyScore1})` : 
                                    match.score1) : 
                                ''}
                        </div>
                        <div class="bracket-team ${match.winner === match.team2 ? 'qualified' : ''}">
                            ${match.team2} 
                            ${match.score2 !== null ? 
                                (match.penaltyScore2 !== null ? 
                                    `${match.score2}(${match.penaltyScore2})` : 
                                    match.score2) : 
                                ''}
                        </div>
                    </div>
                `).join('')}
            </div>
            <div class="bracket-round">
                <h3 style="text-align: center; color: #667eea;">მეოთხედფინალი</h3>
                ${playoffMatches.quarter.map(match => `
                    <div class="bracket-match">
                        <div class="bracket-team ${match.winner === match.team1 ? 'qualified' : ''}">
                            ${match.team1 || 'TBD'} 
                            ${match.score1 !== null ? 
                                (match.penaltyScore1 !== null ? 
                                    `${match.score1}(${match.penaltyScore1})` : 
                                    match.score1) : 
                                ''}
                        </div>
                        <div class="bracket-team ${match.winner === match.team2 ? 'qualified' : ''}">
                            ${match.team2 || 'TBD'} 
                            ${match.score2 !== null ? 
                                (match.penaltyScore2 !== null ? 
                                    `${match.score2}(${match.penaltyScore2})` : 
                                    match.score2) : 
                                ''}
                        </div>
                    </div>
                `).join('')}
            </div>
            <div class="bracket-round">
                <h3 style="text-align: center; color: #667eea;">ნახევარფინალი</h3>
                ${playoffMatches.semi.map(match => `
                    <div class="bracket-match">
                        <div class="bracket-team ${match.winner === match.team1 ? 'qualified' : ''}">
                            ${match.team1 || 'TBD'} 
                            ${match.score1 !== null ? 
                                (match.penaltyScore1 !== null ? 
                                    `${match.score1}(${match.penaltyScore1})` : 
                                    match.score1) : 
                                ''}
                        </div>
                        <div class="bracket-team ${match.winner === match.team2 ? 'qualified' : ''}">
                            ${match.team2 || 'TBD'} 
                            ${match.score2 !== null ? 
                                (match.penaltyScore2 !== null ? 
                                    `${match.score2}(${match.penaltyScore2})` : 
                                    match.score2) : 
                                ''}
                        </div>
                    </div>
                `).join('')}
            </div>
            <div class="bracket-round">
                <h3 style="text-align: center; color: #667eea;">ფინალი</h3>
                ${playoffMatches.final.map(match => `
                    <div class="bracket-match">
                        <div class="bracket-team ${match.winner === match.team1 ? 'qualified' : ''}">
                            ${match.team1 || 'TBD'} 
                            ${match.score1 !== null ? 
                                (match.penaltyScore1 !== null ? 
                                    `${match.score1}(${match.penaltyScore1})` : 
                                    match.score1) : 
                                ''}
                        </div>
                        <div class="bracket-team ${match.winner === match.team2 ? 'qualified' : ''}">
                            ${match.team2 || 'TBD'} 
                            ${match.score2 !== null ? 
                                (match.penaltyScore2 !== null ? 
                                    `${match.score2}(${match.penaltyScore2})` : 
                                    match.score2) : 
                                ''}
                        </div>
                    </div>
                `).join('')}
            </div>
        `;
    }

    function updateTopScorers() {
        const container = document.getElementById('topScorersTable');
        if (!container) return;
        
        const playerGoals = {};
        
        scorers.forEach(scorer => {
            if (!playerGoals[scorer.player]) {
                playerGoals[scorer.player] = {
                    player: scorer.player,
                    team: scorer.team,
                    goals: 0
                };
            }
            playerGoals[scorer.player].goals += scorer.goals;
        });
        
        const sortedScorers = Object.values(playerGoals).sort((a, b) => b.goals - a.goals);
        
        if (sortedScorers.length === 0) {
            container.innerHTML = '<p>ჯერ არ არის შეყვანილი გოლები.</p>';
            return;
        }
        
        container.innerHTML = `
            <div class="standings-table">
                <table>
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>მოთამაშე</th>
                            <th>გუნდი</th>
                            <th>გოლები</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${sortedScorers.map((scorer, index) => `
                            <tr>
                                <td class="position">${index + 1}</td>
                                <td><strong>${scorer.player}</strong></td>
                                <td>${scorer.team}</td>
                                <td><strong>${scorer.goals}</strong></td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            </div>
        `;
    }

    function showTab(tabName) {
        document.querySelectorAll('.content').forEach(c => c.classList.remove('active'));
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        document.getElementById(tabName).classList.add('active');
        event.target.classList.add('active');
    }

    // Initialize by loading data
    loadTournamentData();
</script>
</body>
</html>
